## Домашнее задание к занятию «Уязвимости и атаки на информационные системы»

## Шкутов Иван Владимирович

### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя nmap.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?

- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)

Приведите ответ в свободной форме.

### Ответ:

1. Скачал Metasploitable и установил на VMware Workstation.

![1](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/1.png)

2. Проверка доступности машины Metasploitable по сети

![2](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/2.png)

3. Установка nmap и начало сканирование машины Metasploitable. Находим уязвимости.

![3](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/3.png)

![4](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/4.png)

![5](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/5.png)

- vsftpd 2.3.4 backdoor (обратная шелл‑бэкдора)

Exploit‑DB: https://www.exploit-db.com/exploits/17487

Описание: злонамеренная версия vsftpd 2.3.4 содержит бэкдор, при подключении с определённым username запускает обратный шелл.

- UnrealIRCd 3.2.8.1 backdoor (RCE)

Exploit‑DB: https://www.exploit-db.com/exploits/9540

Описание: Trojaned UnrealIRCd содержит удалённое выполнение кода; часто присутствует в Metasploitable.

- Samba smbd (проблемы ранних версий, например trans2open / smbd 3.x exploit — «Samba cry» и др.)

Пример эксплойта (получение root через uids/overflow; конкретный номер зависит от версии): https://www.exploit-db.com/exploits/1555

Описание: старые версии Samba содержат уязвимости, позволяющие выполнить код или получить несанкционированный доступ.
   
### Задание 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?

- Как отвечает сервер?

Приведите ответ в свободной форме.

### Ответ:

- SYN (полуоткрытый, -sS)

Что отправляется (трафик): одиночные TCP-пакеты с флагом SYN к сканируемым портам. Часто большой поток SYN-пакетов на разные порты/пиры.

Wireshark-паттерн: исходящие TCP SYN, входящие SYN/ACK для открытых портов; входящие RST для закрытых портов; отсутствие ответа или ICMP — для фильтрованных.

Как сервер отвечает:

- открытый порт → отвечает SYN/ACK. Сканер обычно отправляет RST сразу (чтобы не завершать соединение)

- закрытый порт → отвечает RST

- пакеты сбрасываются фильтром → нет ответа (или ICMP unreachable — тогда помечается как filtered)
  
![6](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/6.png)



- FIN (никогда не устанавливает SYN; -sF)

Что отправляется (трафик): TCP-пакеты с установленным только флагом FIN к целевым портам.

Wireshark-паттерн: исходящие TCP FIN; для закрытых портов — входящие RST; для открытых портов — обычно отсутствие ответа.

Как сервер отвечает:

- закрытый порт → согласно RFC 793 — отправляет RST
  
- открытый порт (служба слушает) → обычно не отвечает (нет RST) — сканер интерпретирует как open|filtered
  
- если присутствуют фильтрующие устройства — возможно ICMP unreachable → filtered

![7](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/7.png)



- Xmas (Xmas-tree, -sX)

Что отправляется (трафик): TCP-пакеты с флагами FIN, PSH и URG («светящаяся» комбинация).

Wireshark-паттерн: исходящие TCP с FIN+PSH+URG; ответы аналогичны FIN-скану: RST от закрытых портов, отсутствие ответа от открытых.

Как сервер отвечает:

- закрытый порт → RST

- открытый порт → обычно нет ответа → open|filtered

- ICMP unreachable от сетевых фильтров → filtered

![8](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/8.png)


- UDP (-sU)

Что отправляется (трафик): одиночные UDP-датаграммы (часто пустые или с небольшими payload'ами) к целевым портам; существенно медленнее и часто с ретраями.

Wireshark-паттерн: исходящие UDP-пакеты; входящие ICMP Port Unreachable (Type 3, Code 3) для закрытых UDP-портов; отсутствие ответа — open|filtered; иногда ответ UDP от сервисов (DNS, SNMP и т.д.) — означает open.

Как сервер отвечает:

- закрытый UDP-порт → обычно возвращает ICMP Type 3 Code 3 (Port Unreachable).

- открытый UDP-порт (служба слушает) → может ответить UDP-ответом (зависит от протокола) или ничего не отправить (например, сервис не отвечает на пустые пакеты) — тогда open|filtered.

- межсетевые фильтры часто блокируют/дропают ICMP, поэтому много портов будет классифицировано как filtered/ open|filtered.

![9](https://github.com/Ivan-Shkutov/sdb-homeworks-13-01/blob/main/9.png)

### Выыоды:

1. SYN (-sS):

Видите серии исходящих SYN на порты.

Для открытoго порта: SYN → SYN/ACK (ответ) → RST (от сканера).

Для закрытого: SYN → RST.

Для фильтрованного: SYN без ответа или ICMP unreachable.

2. FIN (-sF) и Xmas (-sX):

Видите исходящие FIN или FIN+PSH+URG.

Закрытые порты: входящий RST.

Открытые порты: обычно отсутствие ответа (пауза в Wireshark); Nmap покажет open|filtered.

Если сеть возвращает ICMP unreachable — соответствующие ICMP-пакеты видны.

3. UDP (-sU):

Исходящие UDP-пакеты.

Закрытые порты: возврат ICMP Type 3 Code 3 (Port Unreachable) — легко увидеть.

Открытые UDP-сервисы: ответы UDP (например DNS отвечает) — соответствующие UDP-пакеты.

Частая картина: много «no response» строк — медленная классификация.


